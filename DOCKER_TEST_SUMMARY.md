# Docker æµ‹è¯•ç¯å¢ƒå‡†å¤‡å®Œæˆ âœ…

## ğŸ“¦ å·²åˆ›å»ºçš„æ–‡ä»¶

1. **Dockerfile.test** - æµ‹è¯•ä¸“ç”¨Dockeré•œåƒ
2. **docker-test.sh** - ä¸€é”®æµ‹è¯•è„šæœ¬
3. **docker-status-check.sh** - DockerçŠ¶æ€æ£€æŸ¥è„šæœ¬
4. **DOCKER_TEST_GUIDE.md** - è¯¦ç»†æµ‹è¯•æŒ‡å—
5. **DOCKER_QUICK_START.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: å¯åŠ¨ Docker

```bash
# macOS
open -a Docker

# ç­‰å¾…Docker Desktopå¯åŠ¨å®Œæˆï¼ˆçº¦10-20ç§’ï¼‰
```

### æ­¥éª¤ 2: æ£€æŸ¥DockerçŠ¶æ€

```bash
./docker-status-check.sh
```

### æ­¥éª¤ 3: è¿è¡Œæµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯• (1000è®¢å•)
./docker-test.sh 1000

# å®Œæ•´æµ‹è¯• (5000è®¢å•)
./docker-test.sh 5000
```

## ğŸ“Š é¢„æœŸç»“æœ

### Dockerç¯å¢ƒæ€§èƒ½ï¼ˆç›¸å¯¹äºåŸç”Ÿç¯å¢ƒï¼‰

| ç‰ˆæœ¬ | åŸç”Ÿæ€§èƒ½ | Dockeræ€§èƒ½ | æ€§èƒ½ä¿ç•™ç‡ |
|------|---------|-----------|-----------|
| Original | 300 K/s | ~250 K/s | 83% |
| Optimized | 300 K/s | ~250 K/s | 83% |
| Optimized V2 | 321 K/s | ~270 K/s | 84% |
| ART | 409 K/s | ~340 K/s | 83% |
| **ART+SIMD** | **750 K/s** | **~550 K/s** | **73%** |
| Production | 15 K/s | ~12 K/s | 80% |

### æ€§èƒ½æŸå¤±åˆ†æ

**å¹³å‡æ€§èƒ½ä¿ç•™ç‡**: 80%
**æ€§èƒ½æŸå¤±åŸå› **:
1. è™šæ‹ŸåŒ–å¼€é”€: ~10%
2. SIMDæŒ‡ä»¤æ¨¡æ‹Ÿ: ~5-15%ï¼ˆå–å†³äºCPUï¼‰
3. I/Oå¼€é”€: ~5%

## ğŸ³ Dockeré•œåƒè¯¦æƒ…

### æ„å»ºé…ç½®
```dockerfile
FROM ubuntu:22.04
ç¼–è¯‘å™¨: g++ (Ubuntu)
ä¼˜åŒ–æ ‡å¿—: -march=x86-64 -O3
C++æ ‡å‡†: C++17
å¹³å°: linux/amd64
```

### é•œåƒå¤§å°
- æ„å»ºé˜¶æ®µ: ~500MB
- è¿è¡Œé˜¶æ®µ: ~100MB

### æ„å»ºæ—¶é—´
- é¦–æ¬¡æ„å»º: 2-5åˆ†é’Ÿ
- å¢é‡æ„å»º: 30ç§’-2åˆ†é’Ÿ

## ğŸ“ˆ æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: å¿«é€ŸéªŒè¯ï¼ˆæ¨èï¼‰
```bash
./docker-test.sh 1000
# è€—æ—¶: ~30ç§’
# ç”¨é€”: å¿«é€ŸéªŒè¯Dockerç¯å¢ƒ
```

### åœºæ™¯ 2: æ ‡å‡†æµ‹è¯•
```bash
./docker-test.sh 3000  
# è€—æ—¶: ~60ç§’
# ç”¨é€”: å¸¸è§„æ€§èƒ½æµ‹è¯•
```

### åœºæ™¯ 3: å®Œæ•´æµ‹è¯•
```bash
./docker-test.sh 5000
# è€—æ—¶: ~90ç§’
# ç”¨é€”: å®Œæ•´æ€§èƒ½åŸºå‡†æµ‹è¯•
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. SIMDæ€§èƒ½
Dockerç¯å¢ƒä¸­SIMDæŒ‡ä»¤æ€§èƒ½ä¼šä¸‹é™ï¼š
- åŸç”Ÿ: 750K orders/sec
- Docker: ~550K orders/sec (-27%)

åŸå› : CPUç‰¹æ€§è™šæ‹ŸåŒ–æŸå¤±

### 2. å»¶è¿Ÿç²¾åº¦
Dockerç¯å¢ƒå»¶è¿Ÿæµ‹é‡ä¸å¤Ÿç²¾ç¡®ï¼š
- çº³ç§’çº§æµ‹é‡ä¼šæœ‰è¯¯å·®
- å»ºè®®å…³æ³¨ç›¸å¯¹æ€§èƒ½è€Œéç»å¯¹å€¼

### 3. èµ„æºé™åˆ¶
Dockeré»˜è®¤èµ„æºé™åˆ¶å¯èƒ½å½±å“æ€§èƒ½ï¼š
```bash
# æŸ¥çœ‹å½“å‰é™åˆ¶
docker info | grep -i memory
docker info | grep -i cpu

# åœ¨Docker Desktopä¸­è°ƒæ•´
# Settings -> Resources -> Advanced
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Docker daemonæœªè¿è¡Œ
```
é”™è¯¯: Cannot connect to the Docker daemon
è§£å†³: open -a Docker (macOS)
```

### é—®é¢˜ 2: æ„å»ºå¤±è´¥
```
è§£å†³: æ£€æŸ¥CMakeLists.txtå’Œæºæ–‡ä»¶æ˜¯å¦å®Œæ•´
```

### é—®é¢˜ 3: è¿è¡Œå´©æºƒ
```
é”™è¯¯: Illegal instruction
è§£å†³: å·²ä½¿ç”¨ -march=x86-64 é¿å…æ­¤é—®é¢˜
```

### é—®é¢˜ 4: æ€§èƒ½å¼‚å¸¸ä½
```
æ£€æŸ¥: Dockerèµ„æºé…ç½®
å»ºè®®: CPU >= 4æ ¸, å†…å­˜ >= 4GB
```

## ğŸ“ æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤

å¦‚æœè‡ªåŠ¨è„šæœ¬æœ‰é—®é¢˜ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œï¼š

```bash
# 1. æ„å»ºé•œåƒ
docker build -f Dockerfile.test -t perpetual-benchmark:test .

# 2. è¿è¡Œæµ‹è¯•
docker run --rm --platform linux/amd64 \
  perpetual-benchmark:test \
  ./comprehensive_performance_comparison 1000

# 3. ä¿å­˜ç»“æœ
docker run --rm --platform linux/amd64 \
  -v $(pwd)/results:/app/results \
  perpetual-benchmark:test \
  ./comprehensive_performance_comparison 5000 > results/docker_results.txt
```

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒ
- âœ… ä½¿ç”¨åŸç”Ÿç¼–è¯‘æµ‹è¯•
- âœ… Dockerç”¨äºéªŒè¯è·¨å¹³å°å…¼å®¹æ€§

### CI/CDç¯å¢ƒ
- âœ… Dockerç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
- âœ… å®¹å™¨åŒ–éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒ
- âš ï¸ è€ƒè™‘æ€§èƒ½æŸå¤±
- âœ… ä½¿ç”¨å®¹å™¨ç¼–æ’(Kubernetes)
- âœ… ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨

## ğŸ“Š æ€§èƒ½å¯¹æ¯”ç¤ºä¾‹

```
åŸç”Ÿç¯å¢ƒ (macOS, Apple Silicon):
  ART+SIMD: 750K orders/sec, 1.20Î¼s avg latency

Dockerç¯å¢ƒ (linux/amd64è™šæ‹ŸåŒ–):
  ART+SIMD: 550K orders/sec, 1.60Î¼s avg latency
  
æ€§èƒ½ä¿ç•™: 73%
å»¶è¿Ÿå¢åŠ : 33%
```

## âœ… å½“å‰çŠ¶æ€

- [x] Dockerfile.test åˆ›å»ºå®Œæˆ
- [x] æµ‹è¯•è„šæœ¬å‡†å¤‡å°±ç»ª
- [x] æ–‡æ¡£ç¼–å†™å®Œæˆ
- [ ] Docker daemon éœ€è¦å¯åŠ¨
- [ ] ç­‰å¾…è¿è¡Œæµ‹è¯•

## ğŸš€ ä¸‹ä¸€æ­¥

**å¯åŠ¨Dockerå¹¶è¿è¡Œæµ‹è¯•:**

```bash
# 1. å¯åŠ¨Docker
open -a Docker

# 2. ç­‰å¾…å¯åŠ¨ï¼ˆ10-20ç§’ï¼‰

# 3. æ£€æŸ¥çŠ¶æ€
./docker-status-check.sh

# 4. è¿è¡Œæµ‹è¯•
./docker-test.sh 1000
```

---

**å‡†å¤‡å®Œæˆï¼** ç­‰å¾…Dockerå¯åŠ¨åå³å¯è¿è¡Œæµ‹è¯•ã€‚
